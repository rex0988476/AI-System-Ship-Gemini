# Global Fishing Watch API æ•´åˆè¨ˆç•«

## ä¸€ã€ç¾æ³åˆ†æ

### 1.1 ç¾æœ‰ç³»çµ±æ¶æ§‹
- **å‰ç«¯**: HTML + JavaScriptï¼ˆLeaflet åœ°åœ–ï¼‰
- **è³‡æ–™ä¾†æº**:
  - `vesselDataGenerator.js` - éš¨æ©Ÿç”Ÿæˆæ¨¡æ“¬èˆ¹éš»è³‡æ–™
  - `eventStorage.js` - å„²å­˜äº‹ä»¶è³‡æ–™ï¼ˆè¨˜æ†¶é«”ï¼‰
  - `vessel_database.js` - æ¨¡æ“¬èˆ¹èˆ¶è³‡æ–™åº«
- **å³æ™‚è­¦ç¤º**: `threatAlertManager.js` - æ¯ 10 ç§’ç”Ÿæˆæ¨¡æ“¬å¨è„…

### 1.2 GFW API åŠŸèƒ½
- **API æª”æ¡ˆ**: `data/gfw_simple.py`
- **åŠŸèƒ½**:
  1. `search_vessel(mmsi)` - æ ¹æ“š MMSI æœå°‹èˆ¹éš»
  2. `get_vessel_events(vessel_id, start_date)` - å–å¾—èˆ¹éš»äº‹ä»¶ï¼ˆæ•é­šæ´»å‹•ç­‰ï¼‰
- **è³‡æ–™æ ¼å¼**: JSON
- **èªè­‰**: Bearer Tokenï¼ˆå·²æä¾›ï¼‰

---

## äºŒã€æ•´åˆç›®æ¨™

### 2.1 æ ¸å¿ƒç›®æ¨™
1. **æ›¿æ›æ¨¡æ“¬è³‡æ–™ç‚ºçœŸå¯¦è³‡æ–™**
   - ç”¨ GFW API å–ä»£ `vesselDataGenerator.js` çš„éš¨æ©Ÿç”Ÿæˆ
   - æä¾›çœŸå¯¦èˆ¹éš» MMSIã€ä½ç½®ã€æ´»å‹•è³‡æ–™

2. **ä¿æŒç¾æœ‰ UI åŠŸèƒ½**
   - å¨è„…è­¦ç¤ºç³»çµ±ç¹¼çºŒé‹ä½œ
   - äº‹ä»¶å¡é¡¯ç¤ºæ ¼å¼ä¸è®Š
   - æ™‚é–“è»¸åŠŸèƒ½æ­£å¸¸

3. **å»ºç«‹å¾Œç«¯æœå‹™**
   - Python Flask/FastAPI ä¼ºæœå™¨
   - æä¾› RESTful API çµ¦å‰ç«¯å‘¼å«
   - å¿«å–æ©Ÿåˆ¶æ¸›å°‘ GFW API å‘¼å«

---

## ä¸‰ã€æ•´åˆæ¶æ§‹è¨­è¨ˆ

### 3.1 ç³»çµ±æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯ (Browser)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  index.html + JavaScript                              â”‚  â”‚
â”‚  â”‚  - threatAlertManager.js (ç›£æ§ç®¡ç†)                   â”‚  â”‚
â”‚  â”‚  - eventStorage.js (äº‹ä»¶å„²å­˜)                         â”‚  â”‚
â”‚  â”‚  - script.js (ä¸»é‚è¼¯)                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†• HTTP (Fetch API)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¾Œç«¯ API ä¼ºæœå™¨ (Python)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Flask/FastAPI Server (Port 5000)                     â”‚  â”‚
â”‚  â”‚  - /api/vessels/random - éš¨æ©Ÿå–å¾—èˆ¹éš»                â”‚  â”‚
â”‚  â”‚  - /api/vessels/{mmsi} - æœå°‹ç‰¹å®šèˆ¹éš»                â”‚  â”‚
â”‚  â”‚  - /api/vessels/{id}/events - å–å¾—èˆ¹éš»äº‹ä»¶           â”‚  â”‚
â”‚  â”‚  - /api/health - å¥åº·æª¢æŸ¥                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†• HTTP                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  gfw_api_service.py (æ¥­å‹™é‚è¼¯)                        â”‚  â”‚
â”‚  â”‚  - å‘¼å« GFW API                                        â”‚  â”‚
â”‚  â”‚  - è³‡æ–™è½‰æ›èˆ‡é©—è­‰                                      â”‚  â”‚
â”‚  â”‚  - å¿«å–ç®¡ç†ï¼ˆRedis/è¨˜æ†¶é«”ï¼‰                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Global Fishing Watch API (å¤–éƒ¨æœå‹™)               â”‚
â”‚  - https://gateway.api.globalfishingwatch.org/v3/          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è³‡æ–™æµç¨‹

#### æƒ…å¢ƒ 1: å¨è„…è­¦ç¤ºç›£æ§
```
1. threatAlertManager.js æ¯ 10 ç§’è§¸ç™¼
   â†“
2. å‘¼å« GET /api/vessels/random
   â†“
3. å¾Œç«¯ API å¾ GFW å–å¾—éš¨æ©Ÿèˆ¹éš»ï¼ˆæˆ–å¿«å–ï¼‰
   â†“
4. è½‰æ›ç‚ºå‰ç«¯æ ¼å¼ {mmsi, vesselName, coordinates, riskScore, ...}
   â†“
5. å‰ç«¯æª¢æŸ¥ riskScore â‰¥ 70 â†’ è§¸ç™¼è­¦ç¤º
   â†“
6. å»ºç«‹äº‹ä»¶å¡ï¼Œé¡¯ç¤ºé€šçŸ¥
```

#### æƒ…å¢ƒ 2: æ‰‹å‹•å»ºç«‹èˆ¹èˆ¶äº‹ä»¶
```
1. ä½¿ç”¨è€…åœ¨ UI è¼¸å…¥ MMSI
   â†“
2. å‘¼å« GET /api/vessels/{mmsi}
   â†“
3. å¾Œç«¯å¾ GFW æœå°‹èˆ¹éš»
   â†“
4. å›å‚³èˆ¹éš»è³‡æ–™ + å»ºè­°é¢¨éšªåˆ†æ•¸
   â†“
5. å‰ç«¯å»ºç«‹äº‹ä»¶å¡
```

#### æƒ…å¢ƒ 3: æŸ¥çœ‹èˆ¹éš»æ­·å²è»Œè·¡
```
1. ä½¿ç”¨è€…é»æ“Šèˆ¹èˆ¶äº‹ä»¶å¡
   â†“
2. å‘¼å« GET /api/vessels/{id}/events?start_date=2024-01-01
   â†“
3. å¾Œç«¯å–å¾— GFW äº‹ä»¶è³‡æ–™ï¼ˆæ•é­šæ´»å‹•ã€æ¸¯å£é€²å‡ºç­‰ï¼‰
   â†“
4. è½‰æ›ç‚º trackPoints æ ¼å¼
   â†“
5. å‰ç«¯é¡¯ç¤ºåœ¨æ™‚é–“è»¸å’Œåœ°åœ–ä¸Š
```

---

## å››ã€æŠ€è¡“å¯¦ä½œç´°ç¯€

### 4.1 å¾Œç«¯ API è¨­è¨ˆ

#### æª”æ¡ˆçµæ§‹
```
UIUX/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app.py                  # Flask/FastAPI ä¸»ç¨‹å¼
â”‚   â”œâ”€â”€ gfw_api_service.py      # GFW API åŒ…è£å™¨
â”‚   â”œâ”€â”€ data_transformer.py     # è³‡æ–™æ ¼å¼è½‰æ›
â”‚   â”œâ”€â”€ config.py               # é…ç½®ï¼ˆAPI Token ç­‰ï¼‰
â”‚   â””â”€â”€ requirements.txt        # Python ä¾è³´
â”œâ”€â”€ data/
â”‚   â””â”€â”€ gfw_simple.py          # ç¾æœ‰æª”æ¡ˆï¼ˆä¿ç•™ä½œåƒè€ƒï¼‰
â””â”€â”€ ...
```

#### API ç«¯é»è¦æ ¼

**1. GET /api/vessels/random**
- **ç”¨é€”**: å–å¾—éš¨æ©Ÿèˆ¹éš»ï¼ˆç”¨æ–¼å¨è„…ç›£æ§ï¼‰
- **å›æ‡‰æ ¼å¼**:
```json
{
  "mmsi": "416123456",
  "vesselName": "æµ·é¾è™Ÿ",
  "coordinates": "14.300Â°N, 114.000Â°E",
  "lat": 14.3,
  "lon": 114.0,
  "riskScore": 75,
  "aisStatus": "å·²é–‹å•Ÿ",
  "speed": 12.5,
  "course": 180,
  "timestamp": "2025-10-08T10:30:00Z",
  "investigationReason": "AIS ä¿¡è™Ÿç•°å¸¸é—œé–‰",
  "vesselId": "gfw_vessel_id_123"
}
```

**2. GET /api/vessels/{mmsi}**
- **ç”¨é€”**: æœå°‹ç‰¹å®š MMSI èˆ¹éš»
- **å›æ‡‰æ ¼å¼**: åŒä¸Š
- **éŒ¯èª¤è™•ç†**: 404 æ‰¾ä¸åˆ°èˆ¹éš»

**3. GET /api/vessels/{vessel_id}/events**
- **ç”¨é€”**: å–å¾—èˆ¹éš»äº‹ä»¶ï¼ˆè½‰ç‚ºè»Œè·¡é»ï¼‰
- **åƒæ•¸**:
  - `start_date` (å¯é¸): èµ·å§‹æ—¥æœŸï¼Œé è¨­ 7 å¤©å‰
  - `limit` (å¯é¸): é™åˆ¶æ•¸é‡ï¼Œé è¨­ 100
- **å›æ‡‰æ ¼å¼**:
```json
{
  "vesselId": "gfw_vessel_id_123",
  "events": [
    {
      "timestamp": "2025-10-01T08:00:00Z",
      "lat": 14.5,
      "lon": 114.2,
      "type": "fishing",
      "description": "æ•é­šæ´»å‹•"
    },
    {
      "timestamp": "2025-10-02T14:30:00Z",
      "lat": 14.8,
      "lon": 114.5,
      "type": "port_entry",
      "description": "é€²å…¥æ¸¯å£"
    }
  ]
}
```

**4. GET /api/health**
- **ç”¨é€”**: å¥åº·æª¢æŸ¥
- **å›æ‡‰**: `{"status": "ok", "gfw_api_status": "connected"}`

### 4.2 é¢¨éšªåˆ†æ•¸è¨ˆç®—é‚è¼¯

ç”±æ–¼ GFW API ä¸ç›´æ¥æä¾›ã€Œå¨è„…åˆ†æ•¸ã€ï¼Œéœ€è¦æ ¹æ“šä»¥ä¸‹å› ç´ è¨ˆç®—ï¼š

```python
def calculate_risk_score(vessel_data, events_data):
    """
    è¨ˆç®—èˆ¹éš»é¢¨éšªåˆ†æ•¸ (0-100)
    """
    base_score = 30  # åŸºç¤åˆ†æ•¸

    # å› ç´  1: æ•é­šæ´»å‹•é »ç‡ï¼ˆ+0~30åˆ†ï¼‰
    fishing_events = [e for e in events_data if e.get('type') == 'fishing']
    if len(fishing_events) > 50:
        base_score += 30
    elif len(fishing_events) > 20:
        base_score += 20
    elif len(fishing_events) > 10:
        base_score += 10

    # å› ç´  2: AIS é—œé–‰äº‹ä»¶ï¼ˆ+20åˆ†ï¼‰
    ais_off_events = [e for e in events_data if 'gap' in e.get('type', '')]
    if ais_off_events:
        base_score += 20

    # å› ç´  3: åœ¨ç‰¹å®šå€åŸŸï¼ˆå—æµ·ç­‰æ•æ„Ÿå€åŸŸï¼‰ï¼ˆ+20åˆ†ï¼‰
    if is_in_sensitive_area(vessel_data.get('lat'), vessel_data.get('lon')):
        base_score += 20

    # å› ç´  4: èˆ¹æ——åœ‹ï¼ˆç‰¹å®šåœ‹å®¶ +10åˆ†ï¼‰
    flag = vessel_data.get('flag', '')
    if flag in ['CHN', 'RUS']:  # ç¤ºä¾‹
        base_score += 10

    # éš¨æ©Ÿè®Šç•°ï¼ˆé¿å…å¤ªæ­»æ¿ï¼‰
    import random
    variance = random.randint(-5, 5)

    return min(100, max(0, base_score + variance))
```

### 4.3 å¿«å–ç­–ç•¥

ç‚ºé¿å…é »ç¹å‘¼å« GFW APIï¼ˆå¯èƒ½æœ‰ rate limitï¼‰ï¼Œéœ€è¦å¿«å–æ©Ÿåˆ¶ï¼š

```python
# ä½¿ç”¨ç°¡å–®çš„è¨˜æ†¶é«”å¿«å–ï¼ˆæˆ– Redisï¼‰
CACHE = {}
CACHE_TTL = 300  # 5 åˆ†é˜

def get_vessel_with_cache(mmsi):
    cache_key = f"vessel:{mmsi}"

    # æª¢æŸ¥å¿«å–
    if cache_key in CACHE:
        data, timestamp = CACHE[cache_key]
        if time.time() - timestamp < CACHE_TTL:
            return data

    # å¿«å–éæœŸï¼Œé‡æ–°å–å¾—
    data = search_vessel(mmsi)
    CACHE[cache_key] = (data, time.time())
    return data
```

### 4.4 å‰ç«¯ä¿®æ”¹

#### ä¿®æ”¹ `vesselDataGenerator.js` â†’ `vesselDataFetcher.js`

**åŸå§‹ï¼ˆæ¨¡æ“¬ï¼‰**:
```javascript
generateRandomVessel() {
  return {
    mmsi: this.generateMMSI(),
    vesselName: this.getRandomVesselName(),
    // ... éš¨æ©Ÿç”Ÿæˆ
  };
}
```

**ä¿®æ”¹å¾Œï¼ˆçœŸå¯¦ APIï¼‰**:
```javascript
async fetchRandomVessel() {
  try {
    const response = await fetch('http://localhost:5000/api/vessels/random');
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('âŒ å–å¾—èˆ¹éš»è³‡æ–™å¤±æ•—:', error);
    // é™ç´šï¼šä½¿ç”¨æ¨¡æ“¬è³‡æ–™
    return this.generateRandomVessel();
  }
}
```

#### ä¿®æ”¹ `threatAlertManager.js`

```javascript
async checkForThreats() {
  // åŸæœ¬: const vesselData = window.vesselDataGenerator.generateRandomVessel();

  // æ”¹ç‚º:
  const vesselData = await window.vesselDataFetcher.fetchRandomVessel();

  console.log(`ğŸ” æª¢æŸ¥èˆ¹éš»: MMSI ${vesselData.mmsi}, å¨è„…åˆ†æ•¸: ${vesselData.riskScore}`);

  if (vesselData.riskScore >= this.alertThreshold) {
    this.triggerAlert(vesselData);
  }
}
```

**é‡è¦**: `checkForThreats()` è®Šç‚º async å‡½æ•¸ï¼Œéœ€è¦ä¿®æ”¹ `setInterval` çš„å‘¼å«æ–¹å¼ã€‚

---

## äº”ã€å¯¦ä½œæ­¥é©Ÿ

### éšæ®µ 1: å¾Œç«¯ API å»ºç«‹ï¼ˆé ä¼° 2-3 å°æ™‚ï¼‰

1. **å»ºç«‹åŸºç¤ Flask å°ˆæ¡ˆ**
   ```bash
   cd UIUX
   mkdir backend
   cd backend
   python3 -m venv venv
   source venv/bin/activate
   pip install flask flask-cors requests
   ```

2. **å¯¦ä½œ `gfw_api_service.py`**
   - åŒ…è£ `gfw_simple.py` åŠŸèƒ½
   - åŠ å…¥å¿«å–æ©Ÿåˆ¶
   - åŠ å…¥é¢¨éšªåˆ†æ•¸è¨ˆç®—

3. **å¯¦ä½œ `app.py`**
   - å»ºç«‹ 4 å€‹ API ç«¯é»
   - åŠ å…¥ CORS æ”¯æ´ï¼ˆå…è¨±å‰ç«¯å‘¼å«ï¼‰
   - éŒ¯èª¤è™•ç†

4. **æ¸¬è©¦ API**
   ```bash
   python app.py
   # æ¸¬è©¦: curl http://localhost:5000/api/vessels/random
   ```

### éšæ®µ 2: å‰ç«¯æ•´åˆï¼ˆé ä¼° 1-2 å°æ™‚ï¼‰

1. **ä¿®æ”¹ `vesselDataGenerator.js`**
   - é‡æ–°å‘½åç‚º `vesselDataFetcher.js`
   - ä¿ç•™èˆŠæ–¹æ³•ä½œç‚ºé™ç´šæ–¹æ¡ˆ
   - åŠ å…¥ async/await API å‘¼å«

2. **ä¿®æ”¹ `threatAlertManager.js`**
   - `checkForThreats()` æ”¹ç‚º async
   - åŠ å…¥éŒ¯èª¤è™•ç†

3. **ä¿®æ”¹ `index.html`**
   - æ›´æ–° script å¼•ç”¨

### éšæ®µ 3: æ¸¬è©¦èˆ‡å„ªåŒ–ï¼ˆé ä¼° 1 å°æ™‚ï¼‰

1. **åŠŸèƒ½æ¸¬è©¦**
   - å¨è„…è­¦ç¤ºæ˜¯å¦æ­£å¸¸è§¸ç™¼
   - äº‹ä»¶å¡æ˜¯å¦æ­£ç¢ºé¡¯ç¤ºçœŸå¯¦è³‡æ–™
   - éŒ¯èª¤è™•ç†æ˜¯å¦æ­£å¸¸ï¼ˆAPI æ–·ç·šæ™‚ï¼‰

2. **æ•ˆèƒ½å„ªåŒ–**
   - æª¢æŸ¥ API å›æ‡‰æ™‚é–“
   - èª¿æ•´å¿«å–æ™‚é–“
   - å„ªåŒ–è³‡æ–™è½‰æ›é‚è¼¯

### éšæ®µ 4: é€²éšåŠŸèƒ½ï¼ˆå¯é¸ï¼‰

1. **èˆ¹éš»æ­·å²è»Œè·¡æ•´åˆ**
   - é»æ“Šèˆ¹èˆ¶äº‹ä»¶æ™‚ï¼Œå¾ GFW å–å¾—çœŸå¯¦è»Œè·¡
   - é¡¯ç¤ºåœ¨æ™‚é–“è»¸å’Œåœ°åœ–ä¸Š

2. **å€åŸŸç›£æ§æ•´åˆ**
   - è¼¸å…¥å€åŸŸåº§æ¨™å¾Œï¼Œå¾ GFW æœå°‹è©²å€åŸŸå…§çš„èˆ¹éš»

3. **è³‡æ–™åº«å„²å­˜**
   - å°‡ GFW è³‡æ–™å„²å­˜åˆ°æœ¬åœ°è³‡æ–™åº«ï¼ˆSQLite/PostgreSQLï¼‰
   - åŠ é€ŸæŸ¥è©¢ï¼Œæ¸›å°‘ API å‘¼å«

---

## å…­ã€é¢¨éšªèˆ‡æŒ‘æˆ°

### 6.1 æ½›åœ¨å•é¡Œ

1. **GFW API Rate Limit**
   - **é¢¨éšª**: æ¯å°æ™‚/æ¯æ—¥å‘¼å«æ¬¡æ•¸é™åˆ¶
   - **è§£æ±º**: åŠ å¼·å¿«å–ï¼Œé™ä½å‘¼å«é »ç‡ï¼ˆå¾ 10 ç§’æ”¹ç‚º 30 ç§’ï¼‰

2. **è³‡æ–™æ ¼å¼å·®ç•°**
   - **é¢¨éšª**: GFW API å›å‚³æ ¼å¼å¯èƒ½èˆ‡é æœŸä¸åŒ
   - **è§£æ±º**: åš´æ ¼è³‡æ–™é©—è­‰ï¼ŒåŠ å…¥é™ç´šæ©Ÿåˆ¶

3. **éåŒæ­¥è™•ç†è¤‡é›œåº¦**
   - **é¢¨éšª**: JavaScript async/await å¯èƒ½å°è‡´ç«¶æ…‹æ¢ä»¶
   - **è§£æ±º**: ä½¿ç”¨ Promise éˆï¼ŒåŠ å…¥è¼‰å…¥ç‹€æ…‹ç®¡ç†

4. **çœŸå¯¦è³‡æ–™å¯èƒ½ç„¡æ³•ç”¢ç”Ÿè¶³å¤ å¨è„…**
   - **é¢¨éšª**: çœŸå¯¦èˆ¹éš»é¢¨éšªåˆ†æ•¸å¯èƒ½éƒ½å¾ˆä½ï¼Œç„¡æ³•æ¸¬è©¦è­¦ç¤ºç³»çµ±
   - **è§£æ±º**:
     - ä¿ç•™ã€Œæ‰‹å‹•è§¸ç™¼æ¨¡æ“¬è­¦ç¤ºã€åŠŸèƒ½
     - èª¿æ•´é¢¨éšªåˆ†æ•¸æ¼”ç®—æ³•åƒæ•¸

### 6.2 é™ç´šæ–¹æ¡ˆ

å¦‚æœ GFW API ç„¡æ³•ä½¿ç”¨ï¼š
```javascript
async fetchRandomVessel() {
  try {
    const response = await fetch('http://localhost:5000/api/vessels/random', {
      timeout: 3000  // 3ç§’è¶…æ™‚
    });
    if (!response.ok) throw new Error('API Error');
    return await response.json();
  } catch (error) {
    console.warn('âš ï¸ API å¤±æ•—ï¼Œä½¿ç”¨æ¨¡æ“¬è³‡æ–™', error);
    return this.generateMockVessel();  // é™ç´šåˆ°æ¨¡æ“¬è³‡æ–™
  }
}
```

---

## ä¸ƒã€æˆåŠŸæŒ‡æ¨™

### æ•´åˆæˆåŠŸçš„æ¨™æº–ï¼š

1. âœ… å¾Œç«¯ API å¯æ­£å¸¸å•Ÿå‹•ï¼Œå¥åº·æª¢æŸ¥é€šé
2. âœ… å‰ç«¯å¯å¾ API å–å¾—çœŸå¯¦èˆ¹éš»è³‡æ–™
3. âœ… å¨è„…è­¦ç¤ºç³»çµ±å¯åµæ¸¬çœŸå¯¦é«˜é¢¨éšªèˆ¹éš»
4. âœ… äº‹ä»¶å¡é¡¯ç¤ºçœŸå¯¦ MMSIã€èˆ¹åã€åº§æ¨™
5. âœ… API å¤±æ•—æ™‚å¯é™ç´šåˆ°æ¨¡æ“¬è³‡æ–™
6. âœ… æ•ˆèƒ½å¯æ¥å—ï¼ˆAPI å›æ‡‰ < 2 ç§’ï¼‰

---

## å…«ã€å¾ŒçºŒæ“´å±•

æ•´åˆå®Œæˆå¾Œï¼Œå¯é€²ä¸€æ­¥æ“´å±•ï¼š

1. **å³æ™‚ AIS è¿½è¹¤**
   - æ•´åˆå…¶ä»– AIS è³‡æ–™æºï¼ˆMarineTraffic, VesselFinderï¼‰
   - WebSocket å³æ™‚æ¨é€

2. **é€²éšå¨è„…æ¨¡å‹**
   - æ©Ÿå™¨å­¸ç¿’æ¨¡å‹é æ¸¬é¢¨éšª
   - çµåˆå¤šæºè³‡æ–™ï¼ˆè¡›æ˜Ÿå½±åƒã€RF ä¿¡è™Ÿï¼‰

3. **æ­·å²è³‡æ–™åˆ†æ**
   - å„²å­˜ GFW è³‡æ–™åˆ°æœ¬åœ°
   - æä¾›è¶¨å‹¢åˆ†æã€çµ±è¨ˆåœ–è¡¨

4. **å¤šä½¿ç”¨è€…æ”¯æ´**
   - å»ºç«‹ä½¿ç”¨è€…ç³»çµ±
   - åˆ†äº«äº‹ä»¶èˆ‡å”ä½œ

---

## ä¹ã€æ™‚ç¨‹è¦åŠƒ

| éšæ®µ | ä»»å‹™ | é ä¼°æ™‚é–“ | è² è²¬äºº |
|------|------|---------|--------|
| 1 | å¾Œç«¯ API å»ºç«‹ | 2-3 å°æ™‚ | Claude |
| 2 | å‰ç«¯æ•´åˆ | 1-2 å°æ™‚ | Claude |
| 3 | æ¸¬è©¦èˆ‡å„ªåŒ– | 1 å°æ™‚ | ä½¿ç”¨è€… + Claude |
| 4 | æ–‡æª”æ’°å¯« | 30 åˆ†é˜ | Claude |
| **ç¸½è¨ˆ** | | **4.5-6.5 å°æ™‚** | |

---

## åã€ç¸½çµ

### æ ¸å¿ƒæ”¹å‹•ï¼š
1. **æ–°å¢**: `backend/` è³‡æ–™å¤¾ï¼ŒåŒ…å« Flask API
2. **ä¿®æ”¹**: `vesselDataGenerator.js` â†’ `vesselDataFetcher.js`ï¼ˆåŠ å…¥ API å‘¼å«ï¼‰
3. **ä¿®æ”¹**: `threatAlertManager.js`ï¼ˆasync åŒ–ï¼‰
4. **ä¿ç•™**: æ‰€æœ‰ç¾æœ‰ UI å’Œäº‹ä»¶è™•ç†é‚è¼¯

### å„ªé»ï¼š
- âœ… ä½¿ç”¨çœŸå¯¦è³‡æ–™ï¼Œæå‡ç³»çµ±å¯ä¿¡åº¦
- âœ… ä¿ç•™æ¨¡æ“¬è³‡æ–™ä½œç‚ºé™ç´šæ–¹æ¡ˆ
- âœ… æ¶æ§‹æ¸…æ™°ï¼Œå‰å¾Œç«¯åˆ†é›¢
- âœ… å¯æ“´å±•æ€§å¼·

### æ³¨æ„äº‹é …ï¼š
- âš ï¸ éœ€è¦ä¿æŒå¾Œç«¯ä¼ºæœå™¨é‹è¡Œ
- âš ï¸ æ³¨æ„ GFW API Rate Limit
- âš ï¸ ç¢ºä¿ CORS è¨­å®šæ­£ç¢º
