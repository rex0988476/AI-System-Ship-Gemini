<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8" />
    <title>Vessel Info & Suspicious Vessels API Tester</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            background: #f8f9fa;
        }

        h2 {
            color: #333;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
            margin-top: 40px;
        }

        input {
            padding: 8px;
            width: 200px;
            font-size: 16px;
            margin-bottom: 10px;
        }

        button {
            padding: 8px 14px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
        }

        button:hover {
            background-color: #0056b3;
        }

        pre {
            background: #222;
            color: #0f0;
            padding: 20px;
            border-radius: 6px;
            white-space: pre-wrap;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
        }

        .section {
            margin-bottom: 20px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>

    <h1>ğŸš¢ API æ¸¬è©¦æ§åˆ¶å°</h1>

    <div class="section">
        <h2>âš ï¸ Suspicious Vessels å€åŸŸå…§å¯ç–‘èˆ¹éš»åˆ—è¡¨</h2>
        <label>ç·¯åº¦ (lat)ï¼š</label><br>
        <input id="latInput" type="text" placeholder="ex: 23.974" /><br>
        <label>ç¶“åº¦ (lon)ï¼š</label><br>
        <input id="lonInput" type="text" placeholder="ex: 120.973" /><br>
        <label>åŠå¾‘ (æµ·é‡Œ)ï¼š</label><br>
        <input id="radiusInput" type="text" placeholder="ex: 150" /><br>
        <button onclick="fetchSuspiciousVessels()">æŸ¥è©¢</button>
        <pre id="suspiciousOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <div class="section">
        <h2>ğŸ“ Vessels Coord å€åŸŸå…§å¯ç–‘èˆ¹éš»åº§æ¨™</h2>
        <label>ç·¯åº¦ (lat)ï¼š</label><br>
        <input id="coordLatInput" type="text" placeholder="ex: 23.974" /><br>
        <label>ç¶“åº¦ (lon)ï¼š</label><br>
        <input id="coordLonInput" type="text" placeholder="ex: 120.973" /><br>
        <label>åŠå¾‘ (æµ·é‡Œ)ï¼š</label><br>
        <input id="coordRadiusInput" type="text" placeholder="ex: 150" /><br>
        <button onclick="fetchVesselsCoord()">æŸ¥è©¢</button>
        <pre id="vesselsCoordOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <div class="section">
        <h2>ğŸ§­ Vessel Track å–®èˆ¹æ­·å²è»Œè·¡</h2>
        <label>MMSIï¼š</label><br>
        <input id="trackMmsiInput" type="text" placeholder="ex: 41200000" /><br>
        <button onclick="fetchVesselTrack()">æŸ¥è©¢</button>
        <pre id="vesselTrackOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <div class="section">
        <h2>â„¹ï¸ Vessel Info å–®èˆ¹è³‡è¨Š</h2>
        <label>è¼¸å…¥ MMSIï¼š</label><br>
        <input id="mmsiInput" type="text" placeholder="ex: 41200000" />
        <button onclick="fetchVesselInfo()">æŸ¥è©¢</button>
        <pre id="vesselInfoOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <div class="section">
        <h2>ğŸ Meandering å¨è„…æ¼”ç®—æ³•â”€â”€èˆªè·¡éŠè•©</h2>
        <label>è¼¸å…¥ MMSIï¼š</label><br>
        <input id="meanderingInput" type="text" placeholder="ex: 41200000" />
        <button onclick="fetchMeandering()">æŸ¥è©¢</button>
        <pre id="meanderingOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <div class="section">
        <h2>ğŸŒ Loitering å¨è„…æ¼”ç®—æ³•â”€â”€èˆªè·¡ç•°å¸¸åœç•™</h2>
        <label>è¼¸å…¥ MMSIï¼š</label><br>
        <input id="loiteringInput" type="text" placeholder="ex: 41200000" />
        <button onclick="fetchLoitering()">æŸ¥è©¢</button>
        <pre id="loiteringOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <div class="section">
        <h2>ğŸ“‰ Speed Drop å¨è„…æ¼”ç®—æ³•â”€â”€èˆªé€Ÿé©Ÿé™</h2>
        <label>è¼¸å…¥ MMSIï¼š</label><br>
        <input id="speedDropInput" type="text" placeholder="ex: 41200000" />
        <button onclick="fetchSpeedDrop()">æŸ¥è©¢</button>
        <pre id="speedDropOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <div class="section">
        <h2>ğŸ”• AIS Switch å¨è„…æ¼”ç®—æ³•â”€â”€èµ°ç§å€åŸŸå…§AISé »ç¹é–‹é—œ</h2>
        <label>è¼¸å…¥ MMSIï¼š</label><br>
        <input id="aisSwitchInput" type="text" placeholder="ex: 41200000" />
        <button onclick="fetchAisSwitch()">æŸ¥è©¢</button>
        <pre id="aisSwitchOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <div class="section">
        <h2>ğŸ“¡ Tracking Event è¿½è¹¤äº‹ä»¶ç´€éŒ„</h2>
        <label>è¼¸å…¥ MMSIï¼š</label><br>
        <input id="trackingEventInput" type="text" placeholder="ex: 41200000" />
        <button onclick="fetchTrackingEvent()">æŸ¥è©¢</button>
        <pre id="trackingEventOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <div class="section">
        <h2>ğŸš€ Dispatch Event ä»»å‹™æ´¾é£ç´€éŒ„</h2>
        <label>è¼¸å…¥ MMSIï¼š</label><br>
        <input id="dispatchEventInput" type="text" placeholder="ex: 41200000" />
        <button onclick="fetchDispatchEvent()">æŸ¥è©¢</button>
        <pre id="dispatchEventOutput">çµæœæœƒé¡¯ç¤ºåœ¨é€™è£¡...</pre>
    </div>

    <script>
        const HOST = '140.115.53.51';
        const PORT = 3000;

        // å…±ç”¨çš„ Fetch å‡½å¼ï¼Œæ¸›å°‘é‡è¤‡ä»£ç¢¼
        async function fetchApi(endpoint, params, outputId) {
            const output = document.getElementById(outputId);
            const queryString = new URLSearchParams(params).toString();
            // æ³¨æ„ï¼šé€™è£¡å‡è¨­æ‰€æœ‰è·¯ç”±éƒ½æ›åœ¨ api/v1 ä¸‹
            const url = `http://${HOST}:${PORT}/api/v1/${endpoint}?${queryString}`;

            try {
                output.textContent = "â³ æŸ¥è©¢ä¸­...";
                const res = await fetch(url);

                if (!res.ok) {
                    // å˜—è©¦è§£æéŒ¯èª¤ JSONï¼Œå¦‚æœå¤±æ•—å‰‡å›å‚³ statusText
                    const err = await res.json().catch(() => ({ error: res.statusText }));
                    output.textContent = "âŒ éŒ¯èª¤ï¼š" + JSON.stringify(err, null, 2);
                    return;
                }

                const data = await res.json();
                output.textContent = JSON.stringify(data, null, 2);

            } catch (error) {
                output.textContent = "âŒ ç„¡æ³•é€£ç·šï¼š" + error;
            }
        }

        // --- æ—¢æœ‰ API ---

        function fetchVesselInfo() {
            const mmsi = document.getElementById("mmsiInput").value.trim();
            if (!mmsi) return alert("è«‹è¼¸å…¥ MMSI!");
            fetchApi('vesselInfo', { mmsi }, 'vesselInfoOutput');
        }

        function fetchSuspiciousVessels() {
            const lat = document.getElementById("latInput").value.trim();
            const lon = document.getElementById("lonInput").value.trim();
            const radius = document.getElementById("radiusInput").value.trim();
            if (!lat || !lon || !radius) return alert("è«‹è¼¸å…¥ lat, lon, radius!");
            fetchApi('suspiciousVessels', { lat, lon, radius }, 'suspiciousOutput');
        }

        function fetchVesselsCoord() {
            const lat = document.getElementById("coordLatInput").value.trim();
            const lon = document.getElementById("coordLonInput").value.trim();
            const radius = document.getElementById("coordRadiusInput").value.trim();
            if (!lat || !lon || !radius) return alert("è«‹è¼¸å…¥ lat, lon, radius!");
            fetchApi('vesselsCoord', { lat, lon, radius }, 'vesselsCoordOutput');
        }

        function fetchVesselTrack() {
            const mmsi = document.getElementById("trackMmsiInput").value.trim();
            if (!mmsi) return alert("è«‹è¼¸å…¥ MMSI!");
            fetchApi('vesselTrack', { mmsi }, 'vesselTrackOutput');
        }

        function fetchLoitering() {
            const mmsi = document.getElementById("loiteringInput").value.trim();
            if (!mmsi) return alert("è«‹è¼¸å…¥ MMSI!");
            fetchApi('loitering', { mmsi }, 'loiteringOutput');
        }

        function fetchSpeedDrop() {
            const mmsi = document.getElementById("speedDropInput").value.trim();
            if (!mmsi) return alert("è«‹è¼¸å…¥ MMSI!");
            fetchApi('speedDrop', { mmsi }, 'speedDropOutput');
        }

        function fetchAisSwitch() {
            const mmsi = document.getElementById("aisSwitchInput").value.trim();
            if (!mmsi) return alert("è«‹è¼¸å…¥ MMSI!");
            fetchApi('aisSwitch', { mmsi }, 'aisSwitchOutput');
        }

        function fetchMeandering() {
            const mmsi = document.getElementById("meanderingInput").value.trim();
            if (!mmsi) return alert("è«‹è¼¸å…¥ MMSI!");
            fetchApi('meandering', { mmsi }, 'meanderingOutput');
        }

        // --- æ–°å¢ API ---

        function fetchTrackingEvent() {
            const mmsi = document.getElementById("trackingEventInput").value.trim();
            if (!mmsi) return alert("è«‹è¼¸å…¥ MMSI!");
            fetchApi('trackingEvent', { mmsi }, 'trackingEventOutput');
        }

        function fetchDispatchEvent() {
            const mmsi = document.getElementById("dispatchEventInput").value.trim();
            if (!mmsi) return alert("è«‹è¼¸å…¥ MMSI!");
            fetchApi('dispatchEvent', { mmsi }, 'dispatchEventOutput');
        }

    </script>

</body>

</html>